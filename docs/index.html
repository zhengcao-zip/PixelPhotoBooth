<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RetroPixel Booth</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              'vt323': ['"VT323"', 'monospace'],
            },
            keyframes: {
              'fade-in': {
                '0%': { opacity: '0' },
                '100%': { opacity: '1' },
              },
              'slide-up': {
                '0%': { transform: 'translateY(20px)', opacity: '0' },
                '100%': { transform: 'translateY(0)', opacity: '1' },
              }
            },
            animation: {
              'fade-in': 'fade-in 0.5s ease-out forwards',
              'slide-up': 'slide-up 0.5s ease-out forwards',
            }
          },
        },
      }
    </script>

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel Standalone for in-browser compilation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Import Map for Gemini SDK -->
    <script type="importmap">
    {
      "imports": {
        "@google/genai": "https://esm.run/@google/genai"
      }
    }
    </script>

    <!-- Global Styles -->
    <style>
        body {
            font-family: 'VT323', monospace;
            background-color: #1a0505;
            overflow: hidden;
            margin: 0;
        }
        ::-webkit-scrollbar { width: 10px; }
        ::-webkit-scrollbar-track { background: #000000; }
        ::-webkit-scrollbar-thumb { background: #800020; border-radius: 0px; }
        .pixel-border {
            box-shadow: -4px 0 0 0 black, 4px 0 0 0 black, 0 -4px 0 0 black, 0 4px 0 0 black;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <!-- Application Code -->
    <script type="text/babel" data-type="module" data-presets="typescript,react">
        import { GoogleGenAI } from "@google/genai";
        
        // --- CONFIGURATION ---
        // IMPORTANT: For GitHub Pages, you must manually set your API key here.
        // WARNING: This key will be visible in the source code. Use a restricted key if possible.
        const API_KEY = "YOUR_API_KEY_HERE"; 
        
        // --- TYPES ---
        enum AppState {
            LANDING = 'LANDING',
            COUNTDOWN = 'COUNTDOWN',
            SHOOTING = 'SHOOTING',
            PROCESSING = 'PROCESSING',
            RESULT = 'RESULT'
        }

        interface PhotoData {
            id: string;
            dataUrl: string;
            timestamp: number;
        }

        // --- SERVICES ---
        const generatePhotoStripCaption = async (base64Image: string): Promise<string> => {
            if (!API_KEY || API_KEY === "YOUR_API_KEY_HERE") {
                return "Error: API Key missing in index.html source code.";
            }
            
            try {
                const ai = new GoogleGenAI({ apiKey: API_KEY });
                const model = 'gemini-2.5-flash';
                
                const prompt = `
                You are the internal computer of a vintage 1980s photobooth. 
                Analyze this photo strip. 
                Generate a very short, nostalgic, quirky, or slightly cryptic "memory log" caption for it.
                Keep it under 10 words. 
                Do not use quotes. 
                Example: "Friends forever. 1985." or "Suspicious activity detected." or "Pure joy captured."
                `;

                const response = await ai.models.generateContent({
                    model: model,
                    contents: {
                        parts: [
                            { inlineData: { data: base64Image, mimeType: 'image/png' } },
                            { text: prompt },
                        ],
                    },
                });

                return response.text?.trim() || "Memory Corrupted. [Error 404]";
            } catch (error) {
                console.error("Gemini Vision Error:", error);
                return "System Offline. Date Unknown.";
            }
        };

        // --- COMPONENTS ---

        // 1. PixelBooth Component
        const PixelBooth = ({ onClick }) => {
            return (
                <div className="flex flex-col items-center justify-center animate-fade-in">
                    <div 
                        onClick={onClick}
                        className="relative w-[320px] h-[480px] group cursor-pointer select-none transition-transform hover:scale-105 duration-300"
                    >
                        {/* Top Banner */}
                        <div className="absolute top-0 left-4 right-4 h-16 bg-[#2b0505] border-4 border-black z-30 flex items-center justify-center shadow-[0_4px_0_rgba(0,0,0,0.3)]">
                            <div className="bg-white border-2 border-black px-4 py-1 flex items-center gap-2 shadow-sm">
                                <span className="font-['VT323'] text-3xl text-black tracking-[0.2em] font-bold">PHOTO</span>
                            </div>
                            <div className="absolute top-2 left-2 w-3 h-3 bg-white border border-black animate-pulse shadow-[0_0_5px_white]"></div>
                            <div className="absolute top-2 right-2 w-3 h-3 bg-white border border-black animate-pulse delay-700 shadow-[0_0_5px_white]"></div>
                            <div className="absolute bottom-2 left-2 w-3 h-3 bg-white border border-black animate-pulse delay-300 shadow-[0_0_5px_white]"></div>
                            <div className="absolute bottom-2 right-2 w-3 h-3 bg-white border border-black animate-pulse delay-1000 shadow-[0_0_5px_white]"></div>
                        </div>

                        {/* Main Structure */}
                        <div className="absolute top-14 left-0 w-full bottom-8 bg-[#4a0404] border-4 border-black flex z-20">
                            {/* Left Panel */}
                            <div className="w-12 h-full bg-[#2b0505] border-r-4 border-black flex flex-col gap-3 py-6 items-center">
                                <div className="w-2 h-2 bg-black/60"></div>
                                <div className="w-2 h-2 bg-black/60"></div>
                                <div className="w-2 h-2 bg-black/60"></div>
                                <div className="w-2 h-2 bg-black/60 mt-auto"></div>
                            </div>

                            {/* Center */}
                            <div className="flex-1 relative bg-[#1a0000] overflow-hidden">
                                <div className="absolute inset-0 flex items-center justify-center bg-[#0f0000]">
                                    <div className="absolute bottom-0 w-24 h-24 bg-black rounded-t-lg"></div>
                                    <div className="absolute top-10 w-24 h-32 bg-gray-800 border-4 border-gray-600 opacity-40"></div>
                                    <span className="z-10 bg-white text-black border border-black px-2 py-1 text-xl font-['VT323'] animate-bounce">ENTER</span>
                                </div>
                                <div className="absolute top-0 left-0 h-full w-1/2 bg-[#800020] border-r-2 border-black/50 origin-left transition-transform duration-500 group-hover:scale-x-25 ease-in-out z-10">
                                    <div className="w-full h-full bg-[repeating-linear-gradient(90deg,transparent,transparent_20px,rgba(0,0,0,0.3)_20px,rgba(0,0,0,0.3)_40px)]"></div>
                                </div>
                                <div className="absolute top-0 right-0 h-full w-1/2 bg-[#800020] border-l-2 border-black/50 origin-right transition-transform duration-500 group-hover:scale-x-25 ease-in-out z-10">
                                    <div className="w-full h-full bg-[repeating-linear-gradient(90deg,transparent,transparent_20px,rgba(0,0,0,0.3)_20px,rgba(0,0,0,0.3)_40px)]"></div>
                                </div>
                            </div>

                            {/* Right Panel */}
                            <div className="w-20 h-full bg-[#2b0505] border-l-4 border-black flex flex-col items-center py-8">
                                <div className="w-10 h-14 bg-black border-2 border-gray-700 mb-2 relative">
                                    <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-1 h-6 bg-gray-800 border border-gray-600"></div>
                                </div>
                                <div className="text-sm text-white font-['VT323'] mb-8 text-center leading-3">INSERT<br/>COIN</div>
                                <div className="flex flex-col gap-2">
                                    <div className="w-6 h-6 rounded-full bg-[#800020] border-2 border-black shadow-[2px_2px_0_black]"></div>
                                    <div className="w-6 h-6 rounded-full bg-white border-2 border-black shadow-[2px_2px_0_black]"></div>
                                </div>
                                <div className="mt-auto mb-8 w-12 h-4 bg-black border-y-2 border-gray-800"></div>
                            </div>
                        </div>

                        {/* Base */}
                        <div className="absolute bottom-0 left-[-10px] right-[-10px] h-8 bg-[#1a0505] border-4 border-black z-10 flex items-center justify-center">
                            <div className="w-full h-2 bg-white/5"></div>
                        </div>
                    </div>
                    
                    <div className="w-[360px] h-6 bg-black/60 rounded-[50%] mt-2 blur-md"></div>
                    
                    <div className="mt-8 text-center">
                        <p className="text-white text-2xl font-['VT323'] tracking-widest animate-pulse drop-shadow-md">
                            [ CLICK MACHINE TO START ]
                        </p>
                    </div>
                </div>
            );
        };

        // 2. CameraCapture Component
        const PHOTO_COUNT = 4;
        const COUNTDOWN_START = 3;

        const CameraCapture = ({ onComplete, onCancel }) => {
            const videoRef = React.useRef(null);
            const canvasRef = React.useRef(null);
            const [stream, setStream] = React.useState(null);
            const [photos, setPhotos] = React.useState([]);
            const [countdown, setCountdown] = React.useState(null);
            const [flash, setFlash] = React.useState(false);
            const [isShooting, setIsShooting] = React.useState(false);
            const [currentShot, setCurrentShot] = React.useState(0);

            React.useEffect(() => {
                let mediaStream = null;
                const startCamera = async () => {
                    try {
                        mediaStream = await navigator.mediaDevices.getUserMedia({
                            video: { width: { ideal: 1280 }, height: { ideal: 720 }, facingMode: "user" },
                            audio: false
                        });
                        setStream(mediaStream);
                        if (videoRef.current) videoRef.current.srcObject = mediaStream;
                    } catch (err) {
                        console.error("Error accessing camera:", err);
                        alert("Cannot access camera. Please check permissions.");
                        onCancel();
                    }
                };
                startCamera();
                return () => { if (mediaStream) mediaStream.getTracks().forEach(track => track.stop()); };
            }, [onCancel]);

            const takePhoto = React.useCallback(() => {
                if (!videoRef.current || !canvasRef.current) return;
                const video = videoRef.current;
                const canvas = canvasRef.current;
                const context = canvas.getContext('2d');

                if (context) {
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    context.translate(canvas.width, 0);
                    context.scale(-1, 1);
                    context.drawImage(video, 0, 0);
                    
                    const dataUrl = canvas.toDataURL('image/jpeg', 0.95);
                    const newPhoto = { id: Date.now().toString(), dataUrl, timestamp: Date.now() };

                    setPhotos(prev => {
                        const updated = [...prev, newPhoto];
                        if (updated.length === PHOTO_COUNT) {
                            setTimeout(() => onComplete(updated), 1000);
                        }
                        return updated;
                    });
                    setFlash(true);
                    setTimeout(() => setFlash(false), 200);
                }
            }, [onComplete]);

            React.useEffect(() => {
                if (!isShooting) return;
                if (currentShot >= PHOTO_COUNT) { setIsShooting(false); return; }

                let timer = COUNTDOWN_START;
                setCountdown(timer);
                const interval = setInterval(() => {
                    timer--;
                    setCountdown(timer);
                    if (timer === 0) {
                        clearInterval(interval);
                        takePhoto();
                        setCountdown(null);
                        setCurrentShot(prev => prev + 1);
                    }
                }, 1000);
                return () => clearInterval(interval);
            }, [isShooting, currentShot, takePhoto]);

            const startSession = () => {
                setIsShooting(true);
                setCurrentShot(0);
                setPhotos([]);
            };

            return (
                <div className="relative w-full h-full bg-black flex flex-col items-center justify-center overflow-hidden">
                    <div className="relative w-full max-w-4xl aspect-video bg-[#1a0505] rounded-lg overflow-hidden border-8 border-[#2b0505] shadow-2xl">
                        <video ref={videoRef} autoPlay playsInline muted className="w-full h-full object-cover transform -scale-x-100" />
                        <div className="absolute inset-0 pointer-events-none" style={{ backdropFilter: 'contrast(1.3) brightness(0.8) saturate(0.4)' }}></div>
                        <div className="absolute inset-0 pointer-events-none opacity-30 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] mix-blend-overlay"></div>
                        <div className="absolute inset-0 pointer-events-none bg-[radial-gradient(circle,transparent_40%,rgba(0,0,0,0.6)_100%)]"></div>
                        {countdown !== null && countdown > 0 && (
                            <div className="absolute inset-0 flex items-center justify-center bg-black/20 backdrop-blur-sm">
                                <span className="text-[12rem] font-bold text-white drop-shadow-[0_0_15px_rgba(255,255,255,0.8)] animate-ping">{countdown}</span>
                            </div>
                        )}
                        <div className={`absolute inset-0 bg-white transition-opacity duration-200 ease-out pointer-events-none ${flash ? 'opacity-100' : 'opacity-0'}`} />
                    </div>

                    {!isShooting && photos.length === 0 && (
                        <div className="mt-8 flex gap-4 z-10">
                            <button onClick={onCancel} className="px-8 py-4 bg-gray-800 hover:bg-gray-700 text-white font-xl border-b-4 border-black active:border-b-0 active:translate-y-1 rounded uppercase tracking-widest transition-all">Exit</button>
                            <button onClick={startSession} className="px-8 py-4 bg-[#800020] hover:bg-[#600018] text-white font-xl border-b-4 border-black active:border-b-0 active:translate-y-1 rounded uppercase tracking-widest transition-all animate-pulse shadow-lg">Start Booth</button>
                        </div>
                    )}
                    
                    {isShooting && <div className="mt-6 text-white text-2xl tracking-widest drop-shadow-md">PHOTO {currentShot + 1} / {PHOTO_COUNT}</div>}
                    <canvas ref={canvasRef} className="hidden" />
                </div>
            );
        };

        // 3. ResultStrip Component
        const ResultStrip = ({ photos, onRetake }) => {
            const canvasRef = React.useRef(null);
            const [stripDataUrl, setStripDataUrl] = React.useState(null);
            const [caption, setCaption] = React.useState("");
            const [isLoadingCaption, setIsLoadingCaption] = React.useState(false);
            const [printing, setPrinting] = React.useState(false);
            const [printComplete, setPrintComplete] = React.useState(false);

            React.useEffect(() => {
                const generateStrip = async () => {
                    if (!canvasRef.current || photos.length === 0) return;
                    const canvas = canvasRef.current;
                    const ctx = canvas.getContext('2d');
                    if (!ctx) return;

                    const photoWidth = 400;
                    const photoHeight = 300;
                    const gap = 20;
                    const paddingX = 24;
                    const paddingY = 24;
                    const bottomSpace = 100;
                    const totalWidth = photoWidth + (paddingX * 2);
                    const totalHeight = (photoHeight * photos.length) + (gap * (photos.length - 1)) + (paddingY * 2) + bottomSpace;

                    canvas.width = totalWidth;
                    canvas.height = totalHeight;

                    // Background
                    ctx.fillStyle = '#000000';
                    ctx.fillRect(0, 0, totalWidth, totalHeight);

                    for (let i = 0; i < photos.length; i++) {
                        const img = new Image();
                        img.src = photos[i].dataUrl;
                        await new Promise((resolve) => { img.onload = resolve; });
                        const x = paddingX;
                        const y = paddingY + (i * (photoHeight + gap));

                        ctx.save();
                        ctx.filter = 'contrast(1.3) brightness(0.8) saturate(0.4)';
                        ctx.drawImage(img, x, y, photoWidth, photoHeight);
                        ctx.filter = 'none';
                        
                        // Vignette
                        const grad = ctx.createRadialGradient(x + photoWidth/2, y + photoHeight/2, photoHeight/3, x + photoWidth/2, y + photoHeight/2, photoHeight/1.1);
                        grad.addColorStop(0.6, 'rgba(0,0,0,0)');
                        grad.addColorStop(1, 'rgba(0,0,0,0.5)');
                        ctx.fillStyle = grad;
                        ctx.globalCompositeOperation = "multiply";
                        ctx.fillRect(x, y, photoWidth, photoHeight);

                        // Noise
                        const noiseCanvas = document.createElement('canvas');
                        noiseCanvas.width = 100; noiseCanvas.height = 100;
                        const nCtx = noiseCanvas.getContext('2d');
                        if (nCtx) {
                            const idata = nCtx.createImageData(100, 100);
                            const buffer32 = new Uint32Array(idata.data.buffer);
                            for (let j = 0; j < buffer32.length; j++) {
                                if (Math.random() < 0.5) buffer32[j] = 0x22FFFFFF; 
                            }
                            nCtx.putImageData(idata, 0, 0);
                            const pattern = ctx.createPattern(noiseCanvas, 'repeat');
                            if (pattern) {
                                ctx.globalCompositeOperation = "overlay";
                                ctx.globalAlpha = 0.3;
                                ctx.fillStyle = pattern;
                                ctx.fillRect(x, y, photoWidth, photoHeight);
                            }
                        }
                        ctx.restore();
                        ctx.strokeStyle = '#333333';
                        ctx.lineWidth = 1;
                        ctx.strokeRect(x, y, photoWidth, photoHeight);
                    }

                    ctx.textAlign = 'right';
                    ctx.font = '18px VT323';
                    ctx.fillStyle = '#888888';
                    const dateStr = new Date().toLocaleDateString();
                    const timeStr = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                    ctx.fillText(`#${Math.floor(Math.random() * 10000)} • ${dateStr} ${timeStr}`, totalWidth - paddingX, totalHeight - 15);

                    if (caption) {
                        ctx.textAlign = 'center';
                        ctx.font = '28px VT323';
                        ctx.fillStyle = '#ffffff';
                        ctx.fillText(caption, totalWidth / 2, totalHeight - 55);
                    }

                    setStripDataUrl(canvas.toDataURL('image/png'));
                };
                generateStrip();
            }, [photos, caption]);

            React.useEffect(() => {
                if (stripDataUrl) {
                    const startTimer = setTimeout(() => setPrinting(true), 100);
                    const endTimer = setTimeout(() => setPrintComplete(true), 5500);
                    return () => { clearTimeout(startTimer); clearTimeout(endTimer); };
                }
            }, [stripDataUrl]);

            const handleDownload = () => {
                if (stripDataUrl) {
                    const link = document.createElement('a');
                    link.download = `photobooth-${Date.now()}.png`;
                    link.href = stripDataUrl;
                    link.click();
                }
            };

            const handleMagicCaption = async () => {
                if (!stripDataUrl) return;
                setIsLoadingCaption(true);
                const base64 = stripDataUrl.split(',')[1];
                const newCaption = await generatePhotoStripCaption(base64);
                setCaption(newCaption);
                setIsLoadingCaption(false);
            };

            return (
                <div className="flex flex-col md:flex-row w-full h-full bg-[#1a0505] text-white overflow-hidden">
                    <div className={`flex-1 h-full bg-[#0f0000] relative flex flex-col items-center justify-center transition-colors duration-500 overflow-hidden`}>
                        <div className="absolute top-0 w-full h-6 bg-[#1a0000] z-20 shadow-[0_15px_20px_-5px_rgba(0,0,0,0.9)] border-b border-gray-800">
                            <div className="absolute bottom-0 left-0 w-full h-[1px] bg-white opacity-20"></div>
                        </div>
                        <div className="fixed inset-0 opacity-5 pointer-events-none bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-white via-transparent to-transparent bg-[length:20px_20px]"></div>
                        <div className={`relative flex-shrink-0 z-10 h-full flex items-center justify-center transition-transform ease-linear will-change-transform ${printing ? 'duration-[5000ms] translate-y-0' : 'duration-0 -translate-y-[150%]'}`}>
                            {stripDataUrl && <img src={stripDataUrl} alt="Printed Strip" className="max-h-[90vh] max-w-[95%] w-auto object-contain shadow-2xl border border-gray-800" />}
                        </div>
                        {!printComplete && printing && <div className="absolute bottom-10 left-1/2 -translate-x-1/2 bg-black border border-white text-white px-4 py-1 rounded font-['VT323'] tracking-widest animate-pulse z-50">PRINTING...</div>}
                    </div>
                    <div className="w-full md:w-96 bg-[#2b0505] p-8 flex flex-col justify-center gap-6 z-30 shadow-2xl border-l border-black relative">
                        {!printComplete && (
                            <div className="absolute inset-0 bg-black/80 z-50 backdrop-blur-[2px] flex flex-col items-center justify-center text-white">
                                <div className="w-8 h-8 border-2 border-white border-t-transparent rounded-full animate-spin mb-4"></div>
                            </div>
                        )}
                        <div className="mb-4 text-center"><h2 className="text-4xl text-white mb-2 tracking-wider">YOUR PHOTOS</h2><p className="text-gray-400 text-lg">Fresh from the lab.</p></div>
                        <button onClick={handleMagicCaption} disabled={isLoadingCaption || !!caption || !printComplete} className={`group relative px-6 py-4 rounded border-2 font-bold text-xl transition-all overflow-hidden ${caption ? 'border-gray-500 text-gray-400 cursor-default' : 'border-white text-white hover:bg-white/10 hover:border-white'}`}>
                            <div className="absolute inset-0 bg-white/10 translate-y-full group-hover:translate-y-0 transition-transform duration-300"></div>
                            <span className="relative flex items-center justify-center gap-2">{isLoadingCaption ? <><span>ANALYZING...</span><span className="animate-spin">◐</span></> : caption ? <span>CAPTION ADDED ✓</span> : <><span>✨ ADD AI MEMORY</span></>}</span>
                        </button>
                        {caption && <div className="bg-black/50 p-4 rounded border border-white/20 text-center animate-fade-in"><p className="text-white text-lg italic">"{caption}"</p></div>}
                        <div className="h-px bg-white/20 my-2"></div>
                        <button onClick={handleDownload} disabled={!printComplete} className="w-full bg-white hover:bg-gray-200 text-black font-bold py-4 text-xl uppercase tracking-widest shadow-[4px_4px_0px_rgba(0,0,0,1)] hover:shadow-[2px_2px_0px_rgba(0,0,0,1)] hover:translate-x-[2px] hover:translate-y-[2px] transition-all border-2 border-black disabled:opacity-50 disabled:cursor-not-allowed">Download Strip</button>
                        <button onClick={onRetake} disabled={!printComplete} className="w-full bg-transparent hover:bg-white/5 text-gray-400 hover:text-white font-bold py-3 text-lg uppercase tracking-widest transition-colors border-2 border-gray-700 hover:border-gray-500 disabled:opacity-50">Trash & Retake</button>
                    </div>
                    <canvas ref={canvasRef} className="hidden" />
                </div>
            );
        };

        // 4. Main App
        const App = () => {
            const [appState, setAppState] = React.useState(AppState.LANDING);
            const [capturedPhotos, setCapturedPhotos] = React.useState([]);

            const handleStart = () => setAppState(AppState.SHOOTING);
            const handleCaptureComplete = (photos) => {
                setCapturedPhotos(photos);
                setAppState(AppState.PROCESSING);
                setTimeout(() => setAppState(AppState.RESULT), 2000);
            };
            const handleRetake = () => {
                setCapturedPhotos([]);
                setAppState(AppState.LANDING);
            };

            return (
                <div className="w-full h-screen bg-[#1a120b] relative overflow-hidden">
                    <div className="absolute inset-0 bg-[radial-gradient(circle_at_center,rgba(80,50,30,0.3)_0%,rgba(10,5,0,0.8)_80%)] pointer-events-none"></div>
                    <div className="absolute bottom-0 left-0 w-full h-1/3 bg-gradient-to-t from-black/40 to-transparent pointer-events-none"></div>
                    <div className="pointer-events-none absolute inset-0 z-50 overflow-hidden h-full w-full opacity-[0.03] bg-[linear-gradient(rgba(18,16,16,0)_50%,rgba(0,0,0,0.25)_50%),linear-gradient(90deg,rgba(255,0,0,0.06),rgba(0,255,0,0.02),rgba(0,0,255,0.06))] bg-[length:100%_4px,3px_100%]"></div>
                    <div className="pointer-events-none absolute inset-0 z-50 bg-[radial-gradient(circle,rgba(0,0,0,0)_60%,rgba(0,0,0,0.4)_100%)]"></div>

                    {appState === AppState.LANDING && (
                        <main className="w-full h-full flex flex-col items-center justify-center animate-fade-in">
                            <PixelBooth onClick={handleStart} />
                        </main>
                    )}
                    {appState === AppState.SHOOTING && (
                        <div className="w-full h-full animate-slide-up">
                            <CameraCapture onComplete={handleCaptureComplete} onCancel={() => setAppState(AppState.LANDING)} />
                        </div>
                    )}
                    {appState === AppState.PROCESSING && (
                        <div className="w-full h-full flex flex-col items-center justify-center bg-black text-white font-mono">
                            <div className="w-16 h-16 border-4 border-t-red-500 border-r-transparent border-b-red-500 border-l-transparent rounded-full animate-spin mb-4"></div>
                            <p className="text-xl tracking-widest animate-pulse">DEVELOPING FILM...</p>
                        </div>
                    )}
                    {appState === AppState.RESULT && (
                        <div className="w-full h-full animate-fade-in">
                            <ResultStrip photos={capturedPhotos} onRetake={handleRetake} />
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>